#include "../include/fpga_interface.h"

#include "xsysmon_hw.h"
#include "xsysmon.h"

#include "xil_printf.h"

static XSysMon adc;
static XSysMon_Config *adc_config;

int main(){

	Game GameInstance;

	fpga_interface_initialize(&GameInstance);
	fpga_interface_initialize_hardware();

	adc_config = XSysMon_LookupConfig(XPAR_XADC_WIZ_0_DEVICE_ID);
	XSysMon_CfgInitialize(&adc, adc_config, adc_config->BaseAddress);

	u16 adc_tab[8];
	uint32_t seed = 0;

    while(1){

    	for(int i = 0; i < 8; i++) {
    		(void)XSysMon_GetStatus(&adc);
    		while(!(XSysMon_GetStatus(&adc) & XSM_SR_EOC_MASK));
    		adc_tab[i] = XSysMon_GetAdcData(&adc, XSM_CH_AUX_MIN + 4) & 0xf;
    	}

    	for(int i = 0; i < 8; i++) {
        	seed |= (tab[i] << (4 * i));
    	}

    }
}

