#pragma once

#include "line2d.hpp"
#include "player.hpp"
#include "point2d.hpp"
#include "textures.h"

#define N_FLOORS        (5)
#define FLOOR_SPACING   (218)
#define REFRESH_FREQ    (75.0f)

#define DELTA_T			0.1
//#define DELTA_T         (1/REFRESH_FREQ)

#define PLAYER_WIDTH    (64)
#define PLAYER_HEIGHT   (64)
#define FLOOR_HEIGHT	(64)

#define ACCELERATION    (-100.0f)
#define MIN_X           (128)
#define MAX_X           (1279 - 128)
#define MIN_Y           (-64)
#define MAX_Y           (1023)

#define PLAYER_MIN_Y	(-2*PLAYER_HEIGHT+1)
#define PLAYER_MAX_Y	(MAX_Y - 2*PLAYER_HEIGHT - PLAYER_HEIGHT / 2)

#define INITIAL_HEIGHT	(32)

class Game{

    private:
        Line2d floors[N_FLOORS];
        unsigned int relativeFloorNumber[N_FLOORS];
        texture_t floorTexture[N_FLOORS];

        Player Player1;
        float gameTime;

        int playerFloor;
        int floorCounter;

        float floorsPosition;
        float backgroundPosition;

        bool isStarted;

        bool PlayerLocked;
        int PlayerLockFloor;

        void chceckCollisionsAndLock(int moveRate);
        void moveFloors(int moveRate);

    public:

        bool gameOver;

        Game();
        void Reset();
        void Display();
        void Run();

        Line2d GetFloor(int FloorIndex);
        texture_t GetFloorTexture(int FloorIndex);
        Player GetPlayer();

        float GetFloorsPosition();
		int GetFloorCount();
};
